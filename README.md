BGRec  
===
基于GrabCut的背景自动提取  
“站在巨人的肩膀上。”

## 简介及用法介绍
### BGRec是什么？
BGRec，全称Background Recorder，旨在通过静止机位录制的一段视频，分析出其中属于背景的画面，并最终得到一张背景图片。  
由于算法较为粗陋，相对静止的画面均被视为背景，相应地，阴影与光照的改变亦会对结果产生干扰。  
已有的传统背景提取方案，用到了较为复杂的算法，同时需要提前进行模型训练。而BGRec是固定算法，不需要提供学习资源即可投入使用，但同时效果不如传统方法令人满意。  
### 用法与注意事项
通过修改每次分析的时间间隔，能够使BGRec适配以不同速度移动的前景。之后，只需固定好相机，对着需求地点拍摄数十秒，即可得到去除期间移动的背景照片。  
1. 通过`run.bat`或执行`python ./src/main.py`运行程序。  
2. 输入媒体源，可以是相机编号，也可以是视频文件路径。  
3. 输入每次执行操作的时间间隔。物体移动速度越慢，建议的间隔时间越长。默认为3秒。
4. 执行过程中，按`q`退出程序，按`s`保存图片到`./res/`文件夹下。
### 设计思路
BGRec得到背景图片的步骤主要共有3步：  
第一步，使用Canny方法对每一帧进行边缘检测，一定程度上去除花纹图案和阴影对背景解析的干扰。将一定时间内的所有边缘图案进行叠加，进一步减小相机像素色彩抖动带来的干扰。  
第二步，对第一步得到的叠加图案进行两两异或，期望以此除去背景轮廓，以此为蒙版对原图案进行GrabCut抠图。  
第三步，将得到的所有残缺背景图进行加权叠加，增大算法容错率，并尽量得到完整的图案。  
